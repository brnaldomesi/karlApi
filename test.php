<?php
/**
 * Created by PhpStorm.
 * User: alur
 * Date: 2018/1/11
 * Time: 01:48
 */

echo "Hello Simplify Address!\r\n0\r\n";

function simplifyAddress($src_string)
{
    $src_array = json_decode($src_string, true);
    if (!$src_array['address_components'] ||
        !$src_array['formatted_address'] ||
        !$src_array['geometry'] ||
        !$src_array['place_id']) {
        return null;
    }
    $dst_array = Array(
        'address_components' => $src_array['address_components'],
        'formatted_address' => $src_array['formatted_address'],
        'geometry' => $src_array['geometry'],
        'place_id' => $src_array['place_id']);
    if ($src_array['types']) {
        $dst_array['types'] = $src_array['types'];
    }
    if ($src_array['name']) {
        $dst_array['name'] = $src_array['name'];
    }
    if ($src_array['icon']) {
        $dst_array['icon'] = $src_array['icon'];
    }
    if ($src_array['vicinity']) {
        $dst_array['vicinity'] = $src_array['vicinity'];
    }
    $dst_string = json_encode((object)$dst_array);
    return $dst_string;
}

//$src_string = "fuck me!";
//$src_string = '{"address_components":[{"long_name":"Roissy-en-France","short_name":"Roissy-en-France","types":["locality","political"]},{"long_name":"Île-de-France","short_name":"Île-de-France","types":["administrative_area_level_1","political"]},{"long_name":"法国","short_name":"FR","types":["country","political"]},{"long_name":"95700","short_name":"95700","types":["postal_code"]}],"adr_address":"<span class=\"postal-code\">95700</span> <span class=\"locality\">Roissy-en-France</span>, <span class=\"country-name\">法国</span>","formatted_address":"95700 Roissy-en-France, 法国","formatted_phone_number":"01 70 36 39 50","geometry":{"location":{"lat":49.0096906,"lng":2.547924500000022},"viewport":{"south":49.00200645,"west":2.504481950000013,"north":49.01272864999999,"east":2.6398809500000198}},"icon":"https://maps.gstatic.com/mapfiles/place_api/icons/airport-71.png","id":"e8f77f4687d16d9ffe5271a8ecb4a6bded1fb3f5","international_phone_number":"+33 1 70 36 39 50","name":"巴黎夏尔·戴高乐机场","photos":[{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÉROPORT</a>"],"width":1024},{"height":3265,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112678566839233647732/photos\">Y K</a>"],"width":4898},{"height":1840,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112433395668470531655/photos\">Miha arnuš</a>"],"width":3264},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/105960006903635623896/photos\">Abhinav Maurya</a>"],"width":4032},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/113985577869453784894/photos\">Steve Peca</a>"],"width":4032},{"height":1936,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112046528732542764044/photos\">Sher Newyork</a>"],"width":2592},{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÉROPORT</a>"],"width":1024},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112379882772381141118/photos\">Nick Ware</a>"],"width":4032},{"height":929,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112383428947248863224/photos\">Kevin Derrig</a>"],"width":2048},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/109310329910385887071/photos\">SukhVeer SiNGH WaraicH</a>"],"width":4032}],"place_id":"ChIJW89MjgM-5kcRLKZbL5jgKwQ","rating":3.4,"reference":"CmRRAAAAxzVYs3rweu99wXYA5HEAr6GlAjVDyPeIFVK68KUK9hQ3NOCW0HLrdKiBvCd58CJbkiEhj1buoNYYZcuFiZIKOv04MLzBmBa45yqH4EFgGehzqYqGGeuYdhAPnsNcHNK3EhDTv9m0RXSZIEMrnOe9Qwn2GhQnYYV_vOb8-T4Sj6XE9ZeE_ZrKUg","reviews":[{"author_name":"xu xixi","author_url":"https://www.google.com/maps/contrib/114410763205390382522/reviews","language":"zh","profile_photo_url":"https://lh3.googleusercontent.com/-kTbn_BOvonQ/AAAAAAAAAAI/AAAAAAAAAAA/AA6ZPT54e6rTVOr_D1f98qei1AzdM5tHnQ/s128-c0x00000000-cc-rp-mo-ba3/photo.jpg","rating":1,"relative_time_description":"2个月前","text":"烂烂烂！永远不会再来！由于晚点，转机只有不到一个小时，没有特别安排只有地勤带着跑两公里从T1到T3.结果飞机还是没赶上。完全没有安排！差","time":1507993292},{"author_name":"frog wong","author_url":"https://www.google.com/maps/contrib/111694611275632061993/reviews","language":"zh","profile_photo_url":"https://lh4.googleusercontent.com/-g9O6Q5zCwEY/AAAAAAAAAAI/AAAAAAAARLU/8wXYl90EwQo/s128-c0x00000000-cc-rp-mo-ba8/photo.jpg","rating":3,"relative_time_description":"10个月前","text":"戴高樂機場\n\n巴黎夏爾·戴高樂機場（法語：Aéroport Paris-Charles-de-Gaulle；IATA代碼：CDG；ICAO代碼：LFPG），多簡稱為戴高樂機場，為歐洲主要航空中心，以法蘭西第五共和國第一任總統夏爾·戴高樂命名。\n機場位於離巴黎市中心東北25公里處的華西（隸屬於法蘭西島大區的瓦勒德瓦茲省），也被稱為華西機場（Roissy）。\n\n戴高樂機場與區域快鐵系統以及高速鐵路TGV系統相連（巴黎戴高樂機場2號車站），每小時可提供三或四班列車次前往巴黎市區。\n\n戴高乐机场\n\n巴黎夏尔·戴高乐机场（法语：Aéroport Paris-Charles-de-Gaulle；IATA代码：CDG；ICAO代码：LFPG），多简称为戴高乐机场，为欧洲主要航空中心，以法兰西第五共和国第一任总统夏尔·戴高乐命名。\n机场位于离巴黎市中心东北25公里处的华西（隶属于法兰西岛大区的瓦勒德瓦兹省），也被称为华西机场（Roissy）。\n\n戴高乐机场与区域快铁系统以及高速铁路TGV系统相连（巴黎戴高乐机场2号车站），每小时可提供三或四班列车次前往巴黎市区。","time":1487243135},{"author_name":"Cindy 冰冰","author_url":"https://www.google.com/maps/contrib/106617937405464753115/reviews","language":"zh","profile_photo_url":"https://lh3.googleusercontent.com/-f0f-_20ZRjk/AAAAAAAAAAI/AAAAAAAAS_4/ohFZYhiAeE4/s128-c0x00000000-cc-rp-mo-ba5/photo.jpg","rating":5,"relative_time_description":"8个月前","text":"💟贵宾室距离我要登机的闸门太远、美中不足、超令人顿足不甚滿意！\n💟何况机场人潮洶湧、常常挤爆、要提早到迖、办理出关手续、否则容易误了航班、可就不妙了！💟👍💙💖💜💛💚👱","time":1492917911},{"author_name":"孙丽芳","author_url":"https://www.google.com/maps/contrib/109359124635018754998/reviews","language":"zh","profile_photo_url":"https://lh6.googleusercontent.com/-poy0flJWTwE/AAAAAAAAAAI/AAAAAAAAAAA/AA6ZPT7DdzMARZ3we3NecyghitHNqjEySQ/s128-c0x00000000-cc-rp-mo/photo.jpg","rating":1,"relative_time_description":"3个月前","text":"垃圾机场，乱七八糟，工作人员很不nice又不耐烦，退税单没解释清楚就给我收走作废了，法国永久拉黑","time":1507392462},{"author_name":"Yihei Li","author_url":"https://www.google.com/maps/contrib/106427706300376384629/reviews","language":"zh","profile_photo_url":"https://lh6.googleusercontent.com/-ho8g3cmYmN4/AAAAAAAAAAI/AAAAAAAAAAA/AA6ZPT6Oe9RYGhAdZe-O0svpvb9t8eB-rg/s128-c0x00000000-cc-rp-mo/photo.jpg","rating":5,"relative_time_description":"1年前","text":"Generally good. Staff are kind and expert. Good duty free shops with reasonable price. It is also an ideal place to catch sight of the retired supersonic airliner-Concorde.\n在T2F坐的飞机。总体而言不错，机场工作人员很专业态度也很好，在过安检门时警报响了，工作人员立刻就知道是什么东西造成的，比起那些一遍一遍翻你的包或者搜你的身的其他机场来说强太多。免税店东西也便宜。\n候机的地方视野很好很适合观飞机。登机廊桥也很赞。就是飞机起降前滑行距离有点长，不过对于一个繁忙的大机场来说情有可原。运气好的话还可以看见放在机场上的协和飞机。","time":1468872959}],"scope":"GOOGLE","types":["airport","point_of_interest","establishment"],"url":"https://maps.google.com/?cid=300580744384456236","utc_offset":60,"vicinity":"Roissy-en-France","website":"http://www.parisaeroport.fr/","html_attributions":[],"latlng":{"lat":49.0096906,"lng":2.547924500000022},"isAirport":true}';
$src_string = '{"address_components":[{"long_name":"Roissy-en-France","short_name":"Roissy-en-France","types":["locality","political"]},{"long_name":"Île-de-France","short_name":"Île-de-France","types":["administrative_area_level_1","political"]},{"long_name":"France","short_name":"FR","types":["country","political"]},{"long_name":"95700","short_name":"95700","types":["postal_code"]}],"adr_address":"<span class=\"postal-code\">95700</span> <span class=\"locality\">Roissy-en-France</span>, <span class=\"country-name\">France</span>","formatted_address":"95700 Roissy-en-France, France","formatted_phone_number":"01 70 36 39 50","geometry":{"location":{"lat":49.0096906,"lng":2.547924500000022},"viewport":{"south":49.00200645,"west":2.504481950000013,"north":49.01272864999999,"east":2.6398809500000198}},"icon":"https://maps.gstatic.com/mapfiles/place_api/icons/airport-71.png","id":"e8f77f4687d16d9ffe5271a8ecb4a6bded1fb3f5","international_phone_number":"+33 1 70 36 39 50","name":"Paris-Charles De Gaulle","photos":[{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÉROPORT</a>"],"width":1024},{"height":3265,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112678566839233647732/photos\">Y K</a>"],"width":4898},{"height":1840,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112433395668470531655/photos\">Miha arnuš</a>"],"width":3264},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/105960006903635623896/photos\">Abhinav Maurya</a>"],"width":4032},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/113985577869453784894/photos\">Steve Peca</a>"],"width":4032},{"height":1936,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112046528732542764044/photos\">Sher Newyork</a>"],"width":2592},{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÉROPORT</a>"],"width":1024},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112379882772381141118/photos\">Nick Ware</a>"],"width":4032},{"height":929,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112383428947248863224/photos\">Kevin Derrig</a>"],"width":2048},{"height":578,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÉROPORT</a>"],"width":1024}],"place_id":"ChIJW89MjgM-5kcRLKZbL5jgKwQ","rating":3.4,"reference":"CmRRAAAAaSLvz7-M850pLcm0OHDcR1oL8jLBtbC1FHbTi0WIVpz1SES_xDeYzZbxxAKIs4zkA1FEZTTU7XqbfQC-8ZW8nTNHp-lGwpbvJtnl0lOWNMLgqU0bYNn5oxMGZs0ZkoS_EhBCdcXIzBelhHgmTzPhiz-1GhTPVBhcfRl4yuv0DiYTu5pDneZ2LQ","reviews":[{"author_name":"Matthieu M.","author_url":"https://www.google.com/maps/contrib/102402148554405086107/reviews","language":"fr","profile_photo_url":"https://lh5.googleusercontent.com/-A7lLTLzfl7I/AAAAAAAAAAI/AAAAAAAAAAA/AFiYof3fdKIK3SD3vq0MZSs7d_9sF3FlNA/s128-c0x00000000-cc-rp-mo-ba4/photo.jpg","rating":4,"relative_time_description":"il y a 2 semaines","text":"L\'aéroport Charles de Gaulle et une véritable industrie du voyage. Tout est très bien indiqué, si on lève les yeux. Le personnel est souriant et serviable. C\'est un plaisir d\'y retourner à chaque voyage.","time":1513502105},{"author_name":"pierre alexis antetomaso","author_url":"https://www.google.com/maps/contrib/102145144293551356809/reviews","language":"fr","profile_photo_url":"https://lh5.googleusercontent.com/-hT6OJf8zj5M/AAAAAAAAAAI/AAAAAAAAAxw/taMjnmnAAhg/s128-c0x00000000-cc-rp-mo/photo.jpg","rating":1,"relative_time_description":"il y a moins d\'une semaine","text":"Attente interminable pour récupérer les valises... Un horaire affiché puis 15min plus tard plus rien... Toilettes dans un état pitoyable et sèche-mains cassés... Tres mauvaise 1ère impression de la France que l’on donne aux touristes ..."}],"vicinity":"Roissy-en-France","types":["airport","point_of_interest","establishment"]}';
$dst_string = simplifyAddress($src_string);
echo $dst_string;

