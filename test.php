<?php
/**
 * Created by PhpStorm.
 * User: alur
 * Date: 2018/1/11
 * Time: 01:48
 */

echo "Hello Simplify Address!\r\n0\r\n";

function simplifyAddress($src_string)
{
    $src_array = json_decode($src_string, true);
    if (!$src_array['address_components'] ||
        !$src_array['formatted_address'] ||
        !$src_array['geometry'] ||
        !$src_array['place_id']) {
        return null;
    }
    $dst_array = Array(
        'address_components' => $src_array['address_components'],
        'formatted_address' => $src_array['formatted_address'],
        'geometry' => $src_array['geometry'],
        'place_id' => $src_array['place_id']);
    if ($src_array['types']) {
        $dst_array['types'] = $src_array['types'];
    }
    if ($src_array['name']) {
        $dst_array['name'] = $src_array['name'];
    }
    if ($src_array['icon']) {
        $dst_array['icon'] = $src_array['icon'];
    }
    if ($src_array['vicinity']) {
        $dst_array['vicinity'] = $src_array['vicinity'];
    }
    $dst_string = json_encode((object)$dst_array);
    return $dst_string;
}

//$src_string = "fuck me!";
//$src_string = '{"address_components":[{"long_name":"Roissy-en-France","short_name":"Roissy-en-France","types":["locality","political"]},{"long_name":"Ãle-de-France","short_name":"Ãle-de-France","types":["administrative_area_level_1","political"]},{"long_name":"æ³•å›½","short_name":"FR","types":["country","political"]},{"long_name":"95700","short_name":"95700","types":["postal_code"]}],"adr_address":"<span class=\"postal-code\">95700</span> <span class=\"locality\">Roissy-en-France</span>, <span class=\"country-name\">æ³•å›½</span>","formatted_address":"95700 Roissy-en-France, æ³•å›½","formatted_phone_number":"01 70 36 39 50","geometry":{"location":{"lat":49.0096906,"lng":2.547924500000022},"viewport":{"south":49.00200645,"west":2.504481950000013,"north":49.01272864999999,"east":2.6398809500000198}},"icon":"https://maps.gstatic.com/mapfiles/place_api/icons/airport-71.png","id":"e8f77f4687d16d9ffe5271a8ecb4a6bded1fb3f5","international_phone_number":"+33 1 70 36 39 50","name":"å·´é»å¤å°”Â·æˆ´é«˜ä¹æœºåœº","photos":[{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÃ‰ROPORT</a>"],"width":1024},{"height":3265,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112678566839233647732/photos\">Y K</a>"],"width":4898},{"height":1840,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112433395668470531655/photos\">Miha arnuÅ¡</a>"],"width":3264},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/105960006903635623896/photos\">Abhinav Maurya</a>"],"width":4032},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/113985577869453784894/photos\">Steve Peca</a>"],"width":4032},{"height":1936,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112046528732542764044/photos\">Sher Newyork</a>"],"width":2592},{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÃ‰ROPORT</a>"],"width":1024},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112379882772381141118/photos\">Nick Ware</a>"],"width":4032},{"height":929,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112383428947248863224/photos\">Kevin Derrig</a>"],"width":2048},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/109310329910385887071/photos\">SukhVeer SiNGH WaraicH</a>"],"width":4032}],"place_id":"ChIJW89MjgM-5kcRLKZbL5jgKwQ","rating":3.4,"reference":"CmRRAAAAxzVYs3rweu99wXYA5HEAr6GlAjVDyPeIFVK68KUK9hQ3NOCW0HLrdKiBvCd58CJbkiEhj1buoNYYZcuFiZIKOv04MLzBmBa45yqH4EFgGehzqYqGGeuYdhAPnsNcHNK3EhDTv9m0RXSZIEMrnOe9Qwn2GhQnYYV_vOb8-T4Sj6XE9ZeE_ZrKUg","reviews":[{"author_name":"xu xixi","author_url":"https://www.google.com/maps/contrib/114410763205390382522/reviews","language":"zh","profile_photo_url":"https://lh3.googleusercontent.com/-kTbn_BOvonQ/AAAAAAAAAAI/AAAAAAAAAAA/AA6ZPT54e6rTVOr_D1f98qei1AzdM5tHnQ/s128-c0x00000000-cc-rp-mo-ba3/photo.jpg","rating":1,"relative_time_description":"2ä¸ªæœˆå‰","text":"çƒ‚çƒ‚çƒ‚ï¼æ°¸è¿œä¸ä¼šå†æ¥ï¼ç”±äºæ™šç‚¹ï¼Œè½¬æœºåªæœ‰ä¸åˆ°ä¸€ä¸ªå°æ—¶ï¼Œæ²¡æœ‰ç‰¹åˆ«å®‰æ’åªæœ‰åœ°å‹¤å¸¦ç€è·‘ä¸¤å…¬é‡Œä»T1åˆ°T3.ç»“æœé£æœºè¿˜æ˜¯æ²¡èµ¶ä¸Šã€‚å®Œå…¨æ²¡æœ‰å®‰æ’ï¼å·®","time":1507993292},{"author_name":"frog wong","author_url":"https://www.google.com/maps/contrib/111694611275632061993/reviews","language":"zh","profile_photo_url":"https://lh4.googleusercontent.com/-g9O6Q5zCwEY/AAAAAAAAAAI/AAAAAAAARLU/8wXYl90EwQo/s128-c0x00000000-cc-rp-mo-ba8/photo.jpg","rating":3,"relative_time_description":"10ä¸ªæœˆå‰","text":"æˆ´é«˜æ¨‚æ©Ÿå ´\n\nå·´é»å¤çˆ¾Â·æˆ´é«˜æ¨‚æ©Ÿå ´ï¼ˆæ³•èªï¼šAÃ©roport Paris-Charles-de-Gaulleï¼›IATAä»£ç¢¼ï¼šCDGï¼›ICAOä»£ç¢¼ï¼šLFPGï¼‰ï¼Œå¤šç°¡ç¨±ç‚ºæˆ´é«˜æ¨‚æ©Ÿå ´ï¼Œç‚ºæ­æ´²ä¸»è¦èˆªç©ºä¸­å¿ƒï¼Œä»¥æ³•è˜­è¥¿ç¬¬äº”å…±å’Œåœ‹ç¬¬ä¸€ä»»ç¸½çµ±å¤çˆ¾Â·æˆ´é«˜æ¨‚å‘½åã€‚\næ©Ÿå ´ä½æ–¼é›¢å·´é»å¸‚ä¸­å¿ƒæ±åŒ—25å…¬é‡Œè™•çš„è¯è¥¿ï¼ˆéš¸å±¬æ–¼æ³•è˜­è¥¿å³¶å¤§å€çš„ç“¦å‹’å¾·ç“¦èŒ²çœï¼‰ï¼Œä¹Ÿè¢«ç¨±ç‚ºè¯è¥¿æ©Ÿå ´ï¼ˆRoissyï¼‰ã€‚\n\næˆ´é«˜æ¨‚æ©Ÿå ´èˆ‡å€åŸŸå¿«éµç³»çµ±ä»¥åŠé«˜é€Ÿéµè·¯TGVç³»çµ±ç›¸é€£ï¼ˆå·´é»æˆ´é«˜æ¨‚æ©Ÿå ´2è™Ÿè»Šç«™ï¼‰ï¼Œæ¯å°æ™‚å¯æä¾›ä¸‰æˆ–å››ç­åˆ—è»Šæ¬¡å‰å¾€å·´é»å¸‚å€ã€‚\n\næˆ´é«˜ä¹æœºåœº\n\nå·´é»å¤å°”Â·æˆ´é«˜ä¹æœºåœºï¼ˆæ³•è¯­ï¼šAÃ©roport Paris-Charles-de-Gaulleï¼›IATAä»£ç ï¼šCDGï¼›ICAOä»£ç ï¼šLFPGï¼‰ï¼Œå¤šç®€ç§°ä¸ºæˆ´é«˜ä¹æœºåœºï¼Œä¸ºæ¬§æ´²ä¸»è¦èˆªç©ºä¸­å¿ƒï¼Œä»¥æ³•å…°è¥¿ç¬¬äº”å…±å’Œå›½ç¬¬ä¸€ä»»æ€»ç»Ÿå¤å°”Â·æˆ´é«˜ä¹å‘½åã€‚\næœºåœºä½äºç¦»å·´é»å¸‚ä¸­å¿ƒä¸œåŒ—25å…¬é‡Œå¤„çš„åè¥¿ï¼ˆéš¶å±äºæ³•å…°è¥¿å²›å¤§åŒºçš„ç“¦å‹’å¾·ç“¦å…¹çœï¼‰ï¼Œä¹Ÿè¢«ç§°ä¸ºåè¥¿æœºåœºï¼ˆRoissyï¼‰ã€‚\n\næˆ´é«˜ä¹æœºåœºä¸åŒºåŸŸå¿«é“ç³»ç»Ÿä»¥åŠé«˜é€Ÿé“è·¯TGVç³»ç»Ÿç›¸è¿ï¼ˆå·´é»æˆ´é«˜ä¹æœºåœº2å·è½¦ç«™ï¼‰ï¼Œæ¯å°æ—¶å¯æä¾›ä¸‰æˆ–å››ç­åˆ—è½¦æ¬¡å‰å¾€å·´é»å¸‚åŒºã€‚","time":1487243135},{"author_name":"Cindy å†°å†°","author_url":"https://www.google.com/maps/contrib/106617937405464753115/reviews","language":"zh","profile_photo_url":"https://lh3.googleusercontent.com/-f0f-_20ZRjk/AAAAAAAAAAI/AAAAAAAAS_4/ohFZYhiAeE4/s128-c0x00000000-cc-rp-mo-ba5/photo.jpg","rating":5,"relative_time_description":"8ä¸ªæœˆå‰","text":"ğŸ’Ÿè´µå®¾å®¤è·ç¦»æˆ‘è¦ç™»æœºçš„é—¸é—¨å¤ªè¿œã€ç¾ä¸­ä¸è¶³ã€è¶…ä»¤äººé¡¿è¶³ä¸ç”šæ»¿æ„ï¼\nğŸ’Ÿä½•å†µæœºåœºäººæ½®æ´¶æ¹§ã€å¸¸å¸¸æŒ¤çˆ†ã€è¦ææ—©åˆ°è¿–ã€åŠç†å‡ºå…³æ‰‹ç»­ã€å¦åˆ™å®¹æ˜“è¯¯äº†èˆªç­ã€å¯å°±ä¸å¦™äº†ï¼ğŸ’ŸğŸ‘ğŸ’™ğŸ’–ğŸ’œğŸ’›ğŸ’šğŸ‘±","time":1492917911},{"author_name":"å­™ä¸½èŠ³","author_url":"https://www.google.com/maps/contrib/109359124635018754998/reviews","language":"zh","profile_photo_url":"https://lh6.googleusercontent.com/-poy0flJWTwE/AAAAAAAAAAI/AAAAAAAAAAA/AA6ZPT7DdzMARZ3we3NecyghitHNqjEySQ/s128-c0x00000000-cc-rp-mo/photo.jpg","rating":1,"relative_time_description":"3ä¸ªæœˆå‰","text":"åƒåœ¾æœºåœºï¼Œä¹±ä¸ƒå…«ç³Ÿï¼Œå·¥ä½œäººå‘˜å¾ˆä¸niceåˆä¸è€çƒ¦ï¼Œé€€ç¨å•æ²¡è§£é‡Šæ¸…æ¥šå°±ç»™æˆ‘æ”¶èµ°ä½œåºŸäº†ï¼Œæ³•å›½æ°¸ä¹…æ‹‰é»‘","time":1507392462},{"author_name":"Yihei Li","author_url":"https://www.google.com/maps/contrib/106427706300376384629/reviews","language":"zh","profile_photo_url":"https://lh6.googleusercontent.com/-ho8g3cmYmN4/AAAAAAAAAAI/AAAAAAAAAAA/AA6ZPT6Oe9RYGhAdZe-O0svpvb9t8eB-rg/s128-c0x00000000-cc-rp-mo/photo.jpg","rating":5,"relative_time_description":"1å¹´å‰","text":"Generally good. Staff are kind and expert. Good duty free shops with reasonable price. It is also an ideal place to catch sight of the retired supersonic airliner-Concorde.\nåœ¨T2Fåçš„é£æœºã€‚æ€»ä½“è€Œè¨€ä¸é”™ï¼Œæœºåœºå·¥ä½œäººå‘˜å¾ˆä¸“ä¸šæ€åº¦ä¹Ÿå¾ˆå¥½ï¼Œåœ¨è¿‡å®‰æ£€é—¨æ—¶è­¦æŠ¥å“äº†ï¼Œå·¥ä½œäººå‘˜ç«‹åˆ»å°±çŸ¥é“æ˜¯ä»€ä¹ˆä¸œè¥¿é€ æˆçš„ï¼Œæ¯”èµ·é‚£äº›ä¸€éä¸€éç¿»ä½ çš„åŒ…æˆ–è€…æœä½ çš„èº«çš„å…¶ä»–æœºåœºæ¥è¯´å¼ºå¤ªå¤šã€‚å…ç¨åº—ä¸œè¥¿ä¹Ÿä¾¿å®œã€‚\nå€™æœºçš„åœ°æ–¹è§†é‡å¾ˆå¥½å¾ˆé€‚åˆè§‚é£æœºã€‚ç™»æœºå»Šæ¡¥ä¹Ÿå¾ˆèµã€‚å°±æ˜¯é£æœºèµ·é™å‰æ»‘è¡Œè·ç¦»æœ‰ç‚¹é•¿ï¼Œä¸è¿‡å¯¹äºä¸€ä¸ªç¹å¿™çš„å¤§æœºåœºæ¥è¯´æƒ…æœ‰å¯åŸã€‚è¿æ°”å¥½çš„è¯è¿˜å¯ä»¥çœ‹è§æ”¾åœ¨æœºåœºä¸Šçš„åå’Œé£æœºã€‚","time":1468872959}],"scope":"GOOGLE","types":["airport","point_of_interest","establishment"],"url":"https://maps.google.com/?cid=300580744384456236","utc_offset":60,"vicinity":"Roissy-en-France","website":"http://www.parisaeroport.fr/","html_attributions":[],"latlng":{"lat":49.0096906,"lng":2.547924500000022},"isAirport":true}';
$src_string = '{"address_components":[{"long_name":"Roissy-en-France","short_name":"Roissy-en-France","types":["locality","political"]},{"long_name":"Ãle-de-France","short_name":"Ãle-de-France","types":["administrative_area_level_1","political"]},{"long_name":"France","short_name":"FR","types":["country","political"]},{"long_name":"95700","short_name":"95700","types":["postal_code"]}],"adr_address":"<span class=\"postal-code\">95700</span> <span class=\"locality\">Roissy-en-France</span>, <span class=\"country-name\">France</span>","formatted_address":"95700 Roissy-en-France, France","formatted_phone_number":"01 70 36 39 50","geometry":{"location":{"lat":49.0096906,"lng":2.547924500000022},"viewport":{"south":49.00200645,"west":2.504481950000013,"north":49.01272864999999,"east":2.6398809500000198}},"icon":"https://maps.gstatic.com/mapfiles/place_api/icons/airport-71.png","id":"e8f77f4687d16d9ffe5271a8ecb4a6bded1fb3f5","international_phone_number":"+33 1 70 36 39 50","name":"Paris-Charles De Gaulle","photos":[{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÃ‰ROPORT</a>"],"width":1024},{"height":3265,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112678566839233647732/photos\">Y K</a>"],"width":4898},{"height":1840,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112433395668470531655/photos\">Miha arnuÅ¡</a>"],"width":3264},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/105960006903635623896/photos\">Abhinav Maurya</a>"],"width":4032},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/113985577869453784894/photos\">Steve Peca</a>"],"width":4032},{"height":1936,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112046528732542764044/photos\">Sher Newyork</a>"],"width":2592},{"height":768,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÃ‰ROPORT</a>"],"width":1024},{"height":3024,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112379882772381141118/photos\">Nick Ware</a>"],"width":4032},{"height":929,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112383428947248863224/photos\">Kevin Derrig</a>"],"width":2048},{"height":578,"html_attributions":["<a href=\"https://maps.google.com/maps/contrib/112480749346514890163/photos\">PARIS AÃ‰ROPORT</a>"],"width":1024}],"place_id":"ChIJW89MjgM-5kcRLKZbL5jgKwQ","rating":3.4,"reference":"CmRRAAAAaSLvz7-M850pLcm0OHDcR1oL8jLBtbC1FHbTi0WIVpz1SES_xDeYzZbxxAKIs4zkA1FEZTTU7XqbfQC-8ZW8nTNHp-lGwpbvJtnl0lOWNMLgqU0bYNn5oxMGZs0ZkoS_EhBCdcXIzBelhHgmTzPhiz-1GhTPVBhcfRl4yuv0DiYTu5pDneZ2LQ","reviews":[{"author_name":"Matthieu M.","author_url":"https://www.google.com/maps/contrib/102402148554405086107/reviews","language":"fr","profile_photo_url":"https://lh5.googleusercontent.com/-A7lLTLzfl7I/AAAAAAAAAAI/AAAAAAAAAAA/AFiYof3fdKIK3SD3vq0MZSs7d_9sF3FlNA/s128-c0x00000000-cc-rp-mo-ba4/photo.jpg","rating":4,"relative_time_description":"il y a 2Â semaines","text":"L\'aÃ©roport Charles de Gaulle et une vÃ©ritable industrie du voyage. Tout est trÃ¨s bien indiquÃ©, si on lÃ¨ve les yeux. Le personnel est souriant et serviable. C\'est un plaisir d\'y retourner Ã  chaque voyage.","time":1513502105},{"author_name":"pierre alexis antetomaso","author_url":"https://www.google.com/maps/contrib/102145144293551356809/reviews","language":"fr","profile_photo_url":"https://lh5.googleusercontent.com/-hT6OJf8zj5M/AAAAAAAAAAI/AAAAAAAAAxw/taMjnmnAAhg/s128-c0x00000000-cc-rp-mo/photo.jpg","rating":1,"relative_time_description":"il y a moins d\'une semaine","text":"Attente interminable pour rÃ©cupÃ©rer les valises... Un horaire affichÃ© puis 15min plus tard plus rien... Toilettes dans un Ã©tat pitoyable et sÃ¨che-mains cassÃ©s... Tres mauvaise 1Ã¨re impression de la France que lâ€™on donne aux touristes ..."}],"vicinity":"Roissy-en-France","types":["airport","point_of_interest","establishment"]}';
$dst_string = simplifyAddress($src_string);
echo $dst_string;

